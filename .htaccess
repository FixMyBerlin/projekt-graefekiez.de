# Redirect all http traffic to https
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# Enable gzip compression for transmission of files (improves performance)
<IfModule mod_deflate.c>
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/shtml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE text/javascript
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# Caching
<IfModule mod_headers.c>
# Two weeks for multimedia files
  <FilesMatch "\.(ico|jpg|jpeg|avif|webp|gif|png|pdf|mp4|eot|woff|woff2)$">
  Header set Cache-Control "public, max-age=1209600, no-transform, must-revalidate"
  </FilesMatch>
# No cache for text files since those are not finger printed and not refreshed when cached
# Two weeks for js, css which is finger printed
  <FilesMatch "\.(js|css)$">
  Header set Cache-Control "public, max-age=1209600, must-revalidate"
  </FilesMatch>
</IfModule>
