# Redirect all http traffic to https
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# Enable gzip compression for transmission of files (improves performance)
<IfModule mod_deflate.c>
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/shtml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE text/javascript
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# Caching
<IfModule mod_headers.c>
# Used Gatsby recommended cache headers, see https://www.gatsbyjs.com/docs/how-to/previews-deploys-hosting/caching/
  <FilesMatch "\.(ico|jpg|jpeg|avif|webp|gif|png|pdf|mp4|eot|woff|woff2)$">
  Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>
  <FilesMatch "\.(js|css)$">
  Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>
  <FilesMatch "\.(html|json)$">
  Header set Cache-Control "public, max-age=0, must-revalidate"
  </FilesMatch>
</IfModule>
